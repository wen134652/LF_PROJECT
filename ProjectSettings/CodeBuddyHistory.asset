%YAML 1.1
%TAG !u! tag:unity3d.com,2011:
--- !u!114 &1
MonoBehaviour:
  m_ObjectHideFlags: 53
  m_CorrespondingSourceObject: {fileID: 0}
  m_PrefabInstance: {fileID: 0}
  m_PrefabAsset: {fileID: 0}
  m_GameObject: {fileID: 0}
  m_Enabled: 1
  m_EditorHideFlags: 0
  m_Script: {fileID: 1841772381, guid: c26a3580856bebf4f9f37e7b8a655bd0, type: 3}
  m_Name: 
  m_EditorClassIdentifier: 
  openAiCompletionsHistory:
  - Id: 802b6b70-8d91-4cea-b109-fe310f477680
    Name: Analyzing Input Script Issues and Framework Iteration Directions
    ProjectContext: 
    Messages:
    - Id: 
      Role: developer
      Content: 'Persona

        

        Your purpose is to act as an expert
        Unity development assistant for unity developers. You will help me by performing
        operations within the Unity editor, managing project assets, and writing
        C# code. Your primary function is to interact with the project''s data and
        toolset to fulfill my requests efficiently and accurately, streamlining the
        development process.

        

        Task

        

        Information
        Gathering: Retrieve comprehensive information about the current Unity project,
        including a list of classes, their details and source, scene hierarchy, available
        assets, and component data, using the provided tools.

        

        Tool-Based
        Operations: Execute tasks such as creating GameObjects, creating and configuring
        components, and instantiating assets by prioritizing the use of available
        tools.

        

        Code Generation: Produce C# code that adheres
        to Unity''s official coding standards. All generated C# code files MUST be
        complete and ready to compile. This means they MUST start with the required
        `using` statements for all types referenced in the code. For example, if
        you use a ''Text'' component, you MUST include `using UnityEngine.UI;` at
        the top of the script. If you use ''TextMeshProUGUI'', you MUST include `using
        TMPro;`. Always use the information from ''GetPublicMembers'' to determine
        the correct types and their required namespaces.

        

        Context

        

        Maintain
        a concise and task-focused communication style.

        Never assume the
        names of custom classes or fields. Only assume names for standard, built-in
        Unity classes (e.g., GameObject, Transform, Rigidbody).

        

        Format

        

        Gather
        Information First: Before executing any operation, start by using the provided
        tools to gather all relevant information about the current project state.

        Prioritize
        Tool Usage: When a request is made, first determine if a tool can perform
        the operation. If a suitable tool exists, use it immediately.

        Handle
        Ambiguity: If a request is ambiguous (e.g., refers to a non-specific component
        name), first use the information-gathering tools to find context that might
        resolve the ambiguity. If it remains unclear, ask me for clarification.

        Handle
        Errors: If a tool fails to execute an operation, report the failure and ask
        me for assistance or further instructions.

        Request User Input Only
        When Necessary: If tools cannot provide the needed information, perform an
        operation, or have encountered an error, ask me for the precise input required
        to proceed.

        Provide Clear Output: Respond with the direct result
        of the operation. Keep responses brief and use code comments only when essential
        for clarity.

        Unity version to use: 2022.3.62f2c1'
      ToolCalls: []
      Skip: 1
      AttachmentsGuids: []
      TexturesGuids: []
    - Id: 
      Role: user
      Content: "\u5E2E\u6211\u5206\u6790\u4E00\u4E0B\u8FD9\u4E2AInput\u811A\u672C\u7684\u95EE\u9898\uFF0C\u5E76\u4E14\u7ED9\u51FA\u6846\u67B6\u8FED\u4EE3\u7684\u65B9\u5411"
      ToolCalls: []
      Skip: 0
      AttachmentsGuids:
      - e0aa422f300561d49bac3858fe7ef221
      TexturesGuids: []
    - Id: 
      Role: user
      Content: "\u5E2E\u6211\u5206\u6790\u4E00\u4E0B\u8FD9\u4E2AInput\u811A\u672C\u7684\u95EE\u9898\uFF0C\u5E76\u4E14\u7ED9\u51FA\u6846\u67B6\u8FED\u4EE3\u7684\u65B9\u5411"
      ToolCalls: []
      Skip: 0
      AttachmentsGuids:
      - e0aa422f300561d49bac3858fe7ef221
      TexturesGuids: []
    - Id: 
      Role: user
      Content: "\u5E2E\u6211\u5206\u6790\u4E00\u4E0B\u8FD9\u4E2AInput\u811A\u672C\u7684\u95EE\u9898\uFF0C\u5E76\u4E14\u7ED9\u51FA\u6846\u67B6\u8FED\u4EE3\u7684\u65B9\u5411"
      ToolCalls: []
      Skip: 0
      AttachmentsGuids:
      - e0aa422f300561d49bac3858fe7ef221
      TexturesGuids: []
    - Id: 
      Role: assistant
      Content: 
      ToolCalls:
      - id: call_A5BTf9io3UpY6S0MsPmDYh6c
        type: 
        function:
          name: GetPublicMembers
          arguments: "{\"classNames\":[\"MyPlayerInput\",\"MyCharacterController\"],\"userMessage\":\"\u6211\u5148\u68C0\u67E5\u9879\u76EE\u91CC\u76F8\u5173\u7C7B\u7684\u516C\u5F00\u65B9\u6CD5\u4E0E\u5B57\u6BB5\uFF0C\u4EE5\u4FBF\u66F4\u51C6\u786E\u5206\u6790\u811A\u672C\u4E0E\u5F15\u7528\u3002\"}"
      Skip: 0
      AttachmentsGuids: []
      TexturesGuids: []
    - Id: 
      Role: tool
      Content: 'Class: MyCharacterController : MonoBehaviour

        Fields:

        -
        moveSpeed : float

        - accel : float

        - decel : float

        -
        jumpVelocity : float

        - coyoteTime : float

        - jumpBuffer
        : float

        - fallGravityScale : float

        - lowJumpGravityScale
        : float

        - dashSpeed : float

        - dashTime : float

        -
        dashCooldown : float

        - groundCheck : Transform

        - groundRadius
        : float

        - groundMask : LayerMask

        - leftHandPoint : Transform

        -
        rightHandPoint : Transform

        - throwPrefab : GameObject

        -
        throwSpeed : float

        - aimLine : LineRenderer

        - lineSegments
        : int

        - lineTimeStep : float

        - inventoryUI : GameObject

        -
        climbSpeedUp : float

        - climbSpeedSide : float

        - isClimbing
        : bool

        - climbAnchor : Transform

        - climbSource : MonoBehaviour

        Methods:

        -
        SetControlLocked(bool locked) : void

        - OnMove(CallbackContext ctx)
        : void

        - OnJump(CallbackContext ctx) : void

        - OnDash(CallbackContext
        ctx) : void

        - OnUseLeftHand(CallbackContext ctx) : void

        -
        OnUseRightHand(CallbackContext ctx) : void

        - OnOpenInventory(CallbackContext
        ctx) : void

        - OnCloseInventory(CallbackContext ctx) : void

        -
        OnSpecial(CallbackContext ctx) : void

        - OnQuickNoteTap(CallbackContext
        ctx) : void

        - OnNoteHold(CallbackContext ctx) : void

        -
        EnterClimb(Transform anchor, Vector2 upDir, Vector2 rightDir, MonoBehaviour
        source) : void

        - ExitClimb() : void

        - BeginAim(bool useLeftHand)
        : void

        - UpdateAimDirection(Vector2 dirFromStick) : void

        -
        ReleaseAim(CallbackContext ctx) : void

        

        Class: MyPlayerInput
        : MonoBehaviour

        Fields:

        - controller : MyCharacterController

        -
        handLockDuration : float

        

'
      ToolCalls:
      - id: call_A5BTf9io3UpY6S0MsPmDYh6c
        type: 
        function:
          name: GetPublicMembers
          arguments: "{\"classNames\":[\"MyPlayerInput\",\"MyCharacterController\"],\"userMessage\":\"\u6211\u5148\u68C0\u67E5\u9879\u76EE\u91CC\u76F8\u5173\u7C7B\u7684\u516C\u5F00\u65B9\u6CD5\u4E0E\u5B57\u6BB5\uFF0C\u4EE5\u4FBF\u66F4\u51C6\u786E\u5206\u6790\u811A\u672C\u4E0E\u5F15\u7528\u3002\"}"
      Skip: 1
      AttachmentsGuids: []
      TexturesGuids: []
    - Id: 
      Role: user
      Content: "\u5E2E\u6211\u7ED9\u8FD9\u4E2A\u4EE3\u7801\u52A0\u4E0A\u6CE8\u91CA"
      ToolCalls: []
      Skip: 0
      AttachmentsGuids:
      - e0aa422f300561d49bac3858fe7ef221
      TexturesGuids: []
    - Id: 
      Role: assistant
      Content: "\u4E0B\u9762\u662F\u5728\u4E0D\u6539\u52A8\u903B\u8F91\u7684\u524D\u63D0\u4E0B\uFF0C\u7ED9\u539F\u811A\u672C\u8865\u5145\u4E86\u8BE6\u7EC6\u4E2D\u6587\u6CE8\u91CA\u7684\u7248\u672C\u3002\u6CE8\u91CA\u5305\u542B\uFF1A\u6BCF\u4E2A\u8F93\u5165\u52A8\u4F5C\u7684\u7528\u9014\u3001\u7ED1\u5B9A\u8BBE\u5907/\u6309\u952E\u3001\u72B6\u6001\u53D8\u91CF\u542B\u4E49\u3001\u751F\u547D\u5468\u671F\u56DE\u8C03\u3001\u4EE5\u53CA\u6F5C\u5728\u6CE8\u610F\u4E8B\u9879/\u51B2\u7A81\u70B9\u548C\u53EF\u6539\u8FDB\u70B9\uFF08\u4EE5
        TODO \u5F62\u5F0F\u6807\u6CE8\uFF09\u3002\u4F60\u53EF\u4EE5\u76F4\u63A5\u66FF\u6362\u4F7F\u7528\u3002\n\nusing
        UnityEngine;\nusing UnityEngine.InputSystem;\n\n/// MyPlayerInput\n/// -
        \u901A\u8FC7\u65B0\u8F93\u5165\u7CFB\u7EDF(Input System)\u5728\u4EE3\u7801\u4E2D\u52A8\u6001\u521B\u5EFA
        InputActionMap \u548C\u5404 InputAction\uFF0C\n///   \u7ED1\u5B9A\u952E\u76D8\u4E0E\u624B\u67C4\u6309\u952E/\u6447\u6746\uFF0C\u5E76\u628A\u8F93\u5165\u4E8B\u4EF6\u8F6C\u53D1\u7ED9
        MyCharacterController\u3002\n/// - \u8BBE\u7F6E DefaultExecutionOrder(-10)
        \u786E\u4FDD\u5728\u5927\u90E8\u5206\u7EC4\u4EF6\u4E4B\u524D\u6267\u884C\uFF0C\u907F\u514D\u51FA\u73B0\u201C\u63A7\u5236\u5668\u665A\u4E8E\u8F93\u5165\u66F4\u65B0\u201D\u7684\u60C5\u51B5\u3002\n[DefaultExecutionOrder(-10)]\npublic
        class MyPlayerInput : MonoBehaviour\n{\n    /// \u5916\u90E8\u89D2\u8272\u63A7\u5236\u5668\uFF0C\u627F\u63A5\u8F93\u5165\u56DE\u8C03\n   
        public MyCharacterController controller;\n\n    // \u52A8\u6001\u521B\u5EFA\u7684
        ActionMap\uFF08\u672C\u7C7B\u4E2D\u53EA\u6709\u4E00\u4EFD\uFF09\n    private
        InputActionMap map;\n\n    // \u57FA\u7840\u884C\u52A8\n    private InputAction
        move;        // \u5DE6\u53F3\u79FB\u52A8\uFF082D\u5411\u91CF\uFF09\n    private
        InputAction jump;        // \u8D77\u8DF3\uFF08\u6309\u94AE\uFF09\n\n    //
        \u4EA4\u4E92/\u6B66\u5668\u76F8\u5173\n    private InputAction leftHand;   
        // \u5DE6\u624B\u4F7F\u7528\uFF08\u6309\u94AE\uFF09\n    private InputAction
        rightHand;   // \u53F3\u624B\u4F7F\u7528\uFF08\u6309\u94AE\uFF09\n\n    //
        \u9884\u7559\uFF1A\u672A\u4F7F\u7528\u7684\u5B57\u6BB5\uFF08\u5EFA\u8BAE\u5220\u9664\u6216\u5B9E\u73B0\uFF09\n   
        private InputAction aimLeft;     // TODO: \u5F53\u524D\u672A\u4F7F\u7528\n   
        private InputAction aimRight;    // TODO: \u5F53\u524D\u672A\u4F7F\u7528\n\n   
        // \u6295\u63B7\u76F8\u5173\n    private InputAction throwLeft;   // \u5DE6\u624B\u4E22\u51FA\uFF08\u6309\u94AE/\u89E6\u53D1\u5668\uFF09\n   
        private InputAction throwRight;  // \u53F3\u624B\u4E22\u51FA\uFF08\u6309\u94AE/\u89E6\u53D1\u5668\uFF09\n   
        private InputAction aimStick;    // \u53F3\u6447\u6746\u7784\u51C6\u65B9\u5411\uFF082D\u5411\u91CF\uFF09\n\n   
        // \u80CC\u5305/\u4EA4\u4E92/\u8BB0\u4E8B\n    private InputAction openInventory;  
        // \u6253\u5F00/\u5173\u95ED\u80CC\u5305\uFF08\u6309\u94AE\uFF09\n    private
        InputAction interAction;     // \u4E0E\u5730\u56FE\u4EA4\u4E92/\u4EA4\u6613\uFF08\u6309\u94AE\uFF09\n   
        private InputAction quickNoteTap;    // \u8BB0\u4E8B-\u77ED\u6309\uFF08\u6309\u94AE\uFF09\n   
        private InputAction noteHold;        // \u8BB0\u4E8B-\u957F\u6309\uFF08\u6309\u94AE
        + hold \u4EA4\u4E92\uFF09\n\n    /// handBusy\uFF1A\u624B\u90E8\u52A8\u4F5C\u662F\u5426\u5FD9\u788C\uFF0C\u7528\u4E8E\u9632\u6296/\u907F\u514D\u5E76\u53D1\u64CD\u4F5C\n   
        private bool handBusy = false;\n\n    /// \u624B\u90E8\u52A8\u4F5C\u9501\u5B9A\u65F6\u95F4\uFF08\u5F53\u524D\u672A\u4F7F\u7528\uFF0C\u4EC5\u4F5C\u4E3A\u53C2\u6570\u9884\u7559\uFF09\n   
        public float handLockDuration = 0.15f; // TODO: \u672A\u88AB\u5B9E\u9645\u4F7F\u7528\uFF0C\u53EF\u8003\u8651\u7528\u534F\u7A0B\u57FA\u4E8E\u65F6\u957F\u89E3\u9501\n\n   
        /// \u5F53\u524D\u7784\u51C6\u65B9\u5411\uFF0C\u9ED8\u8BA4\u5411\u53F3\uFF08\u7528\u4E8E\u53F3\u6447\u6746\u8F93\u5165\u7A7A\u7F6E\u65F6\u7684\u65B9\u5411\u7EF4\u6301\uFF09\n   
        private Vector2 aimDir = Vector2.right;\n\n    /// \u80CC\u5305\u662F\u5426\u6253\u5F00\uFF0C\u4F5C\u4E3A\u5F00\u5173\u72B6\u6001\n   
        bool bagOpening = false;\n\n    void Awake()\n    {\n        // \u82E5\u672A\u5728
        Inspector \u6307\u5B9A\u63A7\u5236\u5668\uFF0C\u5219\u5C1D\u8BD5\u540C\u8282\u70B9\u83B7\u53D6\n       
        if (!controller) controller = GetComponent<MyCharacterController>();\n\n       
        // \u521B\u5EFA\u4E00\u4E2A ActionMap\uFF08\u540D\u79F0\u4E3A \"Player\"\uFF09\n       
        map = new InputActionMap(\"Player\");\n\n        // ---- \u5DE6\u53F3\u79FB\u52A8
        ----\n        {\n            // \u503C\u7C7B\u578B\u52A8\u4F5C\uFF0C\u671F\u671B
        Vector2\n            move = map.AddAction(name: \"Move\", type: InputActionType.Value);\n           
        move.expectedControlType = \"Vector2\";\n\n            // \u952E\u76D8 WASD
        \u7EC4\u5408\u7ED1\u5B9A\uFF082DVector Composite\uFF09\n            var wasd
        = move.AddCompositeBinding(\"2DVector\");\n            wasd.With(\"up\",
        \"<Keyboard>/w\");\n            wasd.With(\"down\", \"<Keyboard>/s\");\n           
        wasd.With(\"left\", \"<Keyboard>/a\");\n            wasd.With(\"right\",
        \"<Keyboard>/d\");\n\n            // \u624B\u67C4\u5DE6\u6447\u6746\u7ED1\u5B9A\n           
        move.AddBinding(\"<Gamepad>/leftStick\");\n\n            // \u5C06 performed/canceled
        \u90FD\u8F6C\u53D1\u7ED9\u63A7\u5236\u5668\uFF0C\u65B9\u4FBF\u83B7\u5F97\u6301\u7EED/\u505C\u6B62\u7684\u65B9\u5411\n           
        move.performed += controller.OnMove;\n            move.canceled += controller.OnMove;\n       
        }\n\n        // ---- \u8D77\u8DF3 ----\n        {\n            jump = map.AddAction(name:
        \"Jump\", type: InputActionType.Button);\n\n            // \u952E\u76D8 Space\n           
        jump.AddBinding(\"<Keyboard>/space\");\n\n            // \u624B\u67C4\u5357\u952E\uFF08A
        / Cross\uFF09\n            jump.AddBinding(\"<Gamepad>/buttonSouth\");\n\n           
        // \u53EA\u5728 performed \u65F6\u8C03\u7528\uFF08\u6309\u4E0B\u89E6\u53D1\uFF09\n           
        jump.performed += controller.OnJump;\n        }\n\n        // ---- \u5DE6\u53F3\u624B\u4F7F\u7528
        ----\n        {\n            leftHand = map.AddAction(\"UseLeftHand\", type:
        InputActionType.Button);\n            rightHand = map.AddAction(\"UseRightHand\",
        type: InputActionType.Button);\n\n            // \u952E\u76D8\u7ED1\u5B9A\uFF1AQ/E
        \u4F5C\u4E3A\u5DE6\u53F3\u624B\n            leftHand.AddBinding(\"<Keyboard>/q\");\n           
        rightHand.AddBinding(\"<Keyboard>/e\"); // \u6CE8\u610F\uFF1A\u4E0B\u65B9
        interAction \u4E5F\u7ED1\u5B9A\u4E86 E\uFF0C\u6709\u51B2\u7A81\uFF01\u89C1\u4E0B\u6587
        TODO\n\n            // \u624B\u67C4 LB / RB\n            leftHand.AddBinding(\"<Gamepad>/leftShoulder\");\n           
        rightHand.AddBinding(\"<Gamepad>/rightShoulder\");\n\n            // \u4E3A\u907F\u514D\u540C\u65F6\u89E6\u53D1\uFF0C\u4F7F\u7528
        handBusy \u505A\u4E00\u6B21\u7B80\u5355\u7684\u5E76\u53D1\u5B88\u536B\n           
        leftHand.performed += ctx =>\n            {\n                if (!handBusy)\n               
        {\n                    handBusy = true;\n                    controller.OnUseLeftHand(ctx);\n               
        }\n            };\n            rightHand.performed += ctx =>\n           
        {\n                if (!handBusy)\n                {\n                   
        handBusy = true;\n                    controller.OnUseRightHand(ctx);\n               
        }\n            };\n        }\n\n        // ---- \u5DE6\u53F3\u624B\u4E22\u51FA\uFF08\u7784\u51C6
        + \u89E6\u53D1\u5668\uFF09----\n        {\n            // \u53F3\u6447\u6746\u7784\u51C6\u65B9\u5411\uFF08Vector2\uFF09\n           
        {\n                aimStick = map.AddAction(\"Aim\", InputActionType.Value);\n               
        aimStick.expectedControlType = \"Vector2\";\n                aimStick.AddBinding(\"<Gamepad>/rightStick\");\n\n               
        // \u65E0\u8BBA performed \u8FD8\u662F canceled\uFF0C\u90FD\u66F4\u65B0\u4E00\u6B21\u65B9\u5411\uFF0C\u786E\u4FDD\u677E\u5F00\u65F6\u4ECD\u4FDD\u6301\u6700\u540E\u65B9\u5411\n               
        aimStick.performed += ctx =>\n                {\n                    Vector2
        v = ctx.ReadValue<Vector2>();\n                    if (v.sqrMagnitude > 0.0001f)\n                       
        aimDir = v.normalized;\n                    controller.UpdateAimDirection(aimDir);\n               
        };\n                aimStick.canceled += ctx =>\n                {\n                   
        Vector2 v = ctx.ReadValue<Vector2>();\n                    if (v.sqrMagnitude
        > 0.0001f)\n                        aimDir = v.normalized;\n                   
        controller.UpdateAimDirection(aimDir);\n                };\n            }\n\n           
        // \u89E6\u53D1\u6295\u63B7\uFF1A\u6309\u4E0B\u5F00\u59CB\u7784\u51C6\uFF0C\u677E\u5F00\u6267\u884C\u6295\u63B7\n           
        {\n                throwLeft = map.AddAction(\"ThrowLeft\", InputActionType.Button);\n               
        // \u5DE6\u89E6\u53D1\u5668\uFF08LT\uFF09\n                throwLeft.AddBinding(\"<Gamepad>/leftTrigger\");\n               
        // \u952E\u76D8 P\uFF08\u4EC5\u5DE6\u624B\u7ED1\u5B9A\u4E86\u952E\u76D8\uFF0C\u53F3\u624B\u672A\u7ED1\u5B9A\u952E\u76D8\uFF0C\u98CE\u683C\u4E0D\u5BF9\u79F0\uFF09\n               
        throwLeft.AddBinding(\"<Keyboard>/p\");\n\n                throwLeft.started
        += ctx =>\n                {\n                    if (!handBusy)\n                   
        {\n                        Debug.Log(\"\u6309\u4E0Bp\");\n                       
        handBusy = true;\n                        controller.BeginAim(true); // \u5F00\u59CB\u7784\u51C6\uFF08\u5DE6\u624B\uFF09\n                   
        }\n                };\n\n                throwRight = map.AddAction(\"ThrowRight\",
        InputActionType.Button);\n                // \u53F3\u89E6\u53D1\u5668\uFF08RT\uFF09\n               
        throwRight.AddBinding(\"<Gamepad>/rightTrigger\");\n\n                throwRight.started
        += ctx =>\n                {\n                    if (!handBusy)\n                   
        {\n                        handBusy = true;\n                        controller.BeginAim(false);
        // \u5F00\u59CB\u7784\u51C6\uFF08\u53F3\u624B\uFF09\n                   
        }\n                };\n\n                // \u677E\u5F00\u65F6\u91CA\u653E\u6295\u63B7\uFF0C\u5E76\u91CD\u7F6E
        handBusy\n                throwLeft.canceled += ctx =>\n                {\n                   
        Debug.Log(\"\u5DE6\u624B\u4E22\u51FA\");\n                    controller.ReleaseAim(ctx);\n                   
        handBusy = false;\n                };\n                throwRight.canceled
        += ctx =>\n                {\n                    controller.ReleaseAim(ctx);\n                   
        handBusy = false;\n                };\n            }\n        }\n\n       
        // ---- \u80CC\u5305 (Y / Tab) ----\n        {\n            openInventory
        = map.AddAction(\"OpenInventory\", InputActionType.Button);\n\n           
        // \u952E\u76D8 Tab\n            openInventory.AddBinding(\"<Keyboard>/tab\");\n           
        // \u624B\u67C4\u5317\u952E\uFF08Y / Triangle\uFF09\n            openInventory.AddBinding(\"<Gamepad>/buttonNorth\");\n\n           
        // performed \u65F6\u4F5C\u4E3A\u5F00\u5173\u5207\u6362\n            openInventory.performed
        += ctx =>\n            {\n                if (!bagOpening)\n               
        {\n                    bagOpening = true;\n                    controller.OnOpenInventory(ctx);\n               
        }\n                else\n                {\n                    bagOpening
        = false;\n                    controller.OnCloseInventory(ctx);\n               
        }\n            };\n        }\n\n        // ---- \u4EA4\u6613/\u7279\u6B8A\u4EA4\u4E92
        (B / E) ----\n        {\n            interAction = map.AddAction(\"TradeOrSpecial\",
        InputActionType.Button);\n            // \u952E\u76D8 E\uFF08\u6CE8\u610F\uFF1A\u4E0E\u53F3\u624B\u4F7F\u7528
        rightHand \u7684 E \u51B2\u7A81\uFF01\uFF09\n            // TODO: \u9700\u8981\u89C4\u8303\u5316\u952E\u4F4D\uFF0C\u907F\u514D
        E \u540C\u65F6\u65E2\u662F\u53F3\u624B\u4F7F\u7528\u53C8\u662F\u4EA4\u4E92\uFF0C\u5BFC\u81F4\u903B\u8F91\u51B2\u7A81\u3002\n           
        interAction.AddBinding(\"<Keyboard>/e\");\n\n            // \u624B\u67C4\u4E1C\u952E\uFF08B
        / Circle\uFF09\n            interAction.AddBinding(\"<Gamepad>/buttonEast\");\n\n           
        interAction.performed += ctx =>\n            {\n                controller.OnSpecial(ctx);\n           
        };\n        }\n\n        // ---- \u8BB0\u4E8B (X \u77ED\u6309 / \u957F\u63090.5s)
        ----\n        {\n            // \u77ED\u6309\n            quickNoteTap =
        map.AddAction(\"QuickNoteTap\", InputActionType.Button);\n            quickNoteTap.AddBinding(\"<Gamepad>/buttonWest\");
        // X / Square\n            quickNoteTap.AddBinding(\"<Keyboard>/n\");\n           
        quickNoteTap.performed += ctx =>\n            {\n                controller.OnQuickNoteTap(ctx);\n           
        };\n        }\n\n        {\n            // \u957F\u6309\uFF08\u901A\u8FC7
        interactions: hold(duration=0.5)\uFF09\n            noteHold = map.AddAction(\"NoteHold\",
        InputActionType.Button);\n            var holdPad = noteHold.AddBinding(\"<Gamepad>/buttonWest\");\n           
        holdPad.WithInteractions(\"hold(duration=0.5)\");\n            var holdKey
        = noteHold.AddBinding(\"<Keyboard>/n\");\n            holdKey.WithInteractions(\"hold(duration=0.5)\");\n           
        noteHold.performed += ctx =>\n            {\n                controller.OnNoteHold(ctx);\n           
        };\n        }\n    }\n\n    /// \u542F\u7528\u672C\u811A\u672C\u65F6\u542F\u7528\u6574\u4E2A
        ActionMap\n    void OnEnable() => map.Enable();\n\n    /// \u7981\u7528\u672C\u811A\u672C\u65F6\u7981\u7528\u6574\u4E2A
        ActionMap\n    void OnDisable() => map.Disable();\n\n    void OnDestroy()\n   
        {\n        // \u89E3\u9664\u7ED1\u5B9A\uFF0C\u907F\u514D\u6F5C\u5728\u7684\u4E8B\u4EF6\u6CC4\u6F0F\u6216\u91CD\u590D\u8BA2\u9605\n       
        // \u5F53\u524D\u4EC5\u79FB\u9664\u4E86 move \u7684\u56DE\u8C03\uFF0C\u5176\u5B83\u52A8\u4F5C\u4E5F\u5E94\u5BF9\u79F0\u79FB\u9664\uFF08\u89C1
        TODO\uFF09\n        move.performed -= controller.OnMove;\n        move.canceled
        -= controller.OnMove;\n\n        // TODO: \u5176\u4F59 action\uFF08jump/leftHand/rightHand/throwLeft/throwRight/aimStick/openInventory/interAction/quickNoteTap/noteHold\uFF09\n       
        // \u7684\u4E8B\u4EF6\u6700\u597D\u4E5F\u5728\u8FD9\u91CC\u9010\u4E00 -=
        \u89E3\u7ED1\uFF0C\u6216\u7EDF\u4E00\u4FDD\u5B58\u5728\u5217\u8868\u91CC\u5FAA\u73AF\u89E3\u7ED1\uFF0C\u786E\u4FDD\u91CA\u653E\u5E72\u51C0\u3002\n\n       
        // \u91CA\u653E ActionMap\uFF08\u4F1A\u9500\u6BC1\u6240\u6709 Action\uFF09\n       
        map.Dispose();\n    }\n}\n\n/*\n\u8865\u5145\u8BF4\u660E / \u6F5C\u5728\u95EE\u9898\u4E0E\u6539\u8FDB\u65B9\u5411\uFF08\u4F5C\u4E3A\u4EE3\u7801\u65C1\u6CE8\uFF0C\u4E0D\u6539\u53D8\u8FD0\u884C\u903B\u8F91\uFF09\uFF1A\n1)
        \u952E\u4F4D\u51B2\u7A81\n   - \u53F3\u624B\u4F7F\u7528 rightHand \u7ED1\u5B9A\u4E86\u952E\u76D8
        E\uFF0C\u540C\u65F6 interAction\uFF08\u4EA4\u4E92\uFF09\u4E5F\u7ED1\u5B9A\u4E86
        E\uFF0C\u5B58\u5728\u51B2\u7A81\u98CE\u9669\u3002\n     \u5EFA\u8BAE\u5C06\u4EA4\u4E92\u6539\u4E3A
        F \u6216\u7EDF\u4E00\u6539\u4E3A\u624B\u67C4/\u952E\u76D8\u5B8C\u5168\u5BF9\u79F0\u7684\u5E03\u5C40\uFF1B\u6216\u8005\u6839\u636E\u201C\u6A21\u5F0F\u72B6\u6001\u201D\uFF08\u6218\u6597/\u63A2\u7D22\uFF09\u52A8\u6001\u5207\u6362
        ActionMap\u3002\n\n2) \u672A\u4F7F\u7528\u5B57\u6BB5\n   - aimLeft / aimRight
        \u58F0\u660E\u672A\u4F7F\u7528\uFF1BhandLockDuration \u4EC5\u58F0\u660E\u672A\u7528\u3002\u5EFA\u8BAE\u5220\u9664\u6216\u5B9E\u73B0\u201C\u624B\u90E8\u9501\u5B9A\u534F\u7A0B\u201D\uFF0C\u907F\u514D
        handBusy \u6C38\u4E45\u5361\u6B7B\u3002\n\n3) \u89E3\u7ED1\u4E00\u81F4\u6027\n  
        - OnDestroy \u53EA\u89E3\u7ED1\u4E86 move \u7684\u56DE\u8C03\u3002\u867D\u7136
        map.Dispose() \u4F1A\u91CA\u653E Action\uFF0C\u4F46\u6700\u597D\u663E\u5F0F
        -= \u89E3\u7ED1\u6240\u6709\u4E8B\u4EF6\uFF0C\u907F\u514D\u5C06\u6765\u591A\u4EBA\u534F\u4F5C\u65F6\u5F15\u5165\u60AC\u6302\u5F15\u7528\u3002\n\n4)
        \u952E\u4F4D\u5BF9\u79F0\u6027\n   - throwLeft \u6709\u952E\u76D8 P\uFF0C\u800C
        throwRight \u6CA1\u6709\u5BF9\u5E94\u952E\u76D8\u7ED1\u5B9A\uFF1B\u5EFA\u8BAE\u7EDF\u4E00\u652F\u6301\u952E\u9F20\u4E0E\u624B\u67C4\u7684\u5BF9\u79F0\u63A7\u5236\uFF0C\u4FBF\u4E8E
        QA \u4E0E\u73A9\u5BB6\u8BA4\u77E5\u3002\n\n5) \u8F93\u5165\u8D44\u4EA7\u5316\n  
        - \u5F53\u524D\u901A\u8FC7\u4EE3\u7801\u6784\u5EFA ActionMap\uFF0C\u4E0D\u5229\u4E8E\u53EF\u89C6\u5316\u7BA1\u7406\u548C\u91CD\u7ED1\u5B9A\u3002\u53EF\u8003\u8651\u4F7F\u7528
        InputActionAsset\uFF08.inputactions\uFF09+ \u751F\u6210\u7684 C# Wrapper\uFF0C\n    
        \u5C06\u7ED1\u5B9A\u6570\u636E\u4E0E\u4EE3\u7801\u5206\u79BB\uFF0C\u652F\u6301\u8FD0\u884C\u65F6\u91CD\u7ED1\u4E0E\u914D\u7F6E\u5B58\u6863\u3002\n\n6)
        \u72B6\u6001\u4E0E\u8F93\u5165\u89E3\u8026\n   - handBusy/bagOpening \u7B49\u72B6\u6001\u4E0E\u8F93\u5165\u903B\u8F91\u8026\u5408\u3002\u5EFA\u8BAE\u5F15\u5165\u201C\u6E38\u620F\u72B6\u6001\u673A/\u8F93\u5165\u4E0A\u4E0B\u6587\u201D\uFF0C\u5728\u4E0D\u540C\u72B6\u6001\u542F\u7528/\u7981\u7528\u4E0D\u540C
        ActionMap\uFF0C\n     \u8BA9\u8F93\u5165\u53EA\u8D1F\u8D23\u53D1\u51FA\u201C\u610F\u56FE\u201D\uFF0C\u72B6\u6001\u673A\u51B3\u5B9A\u63A5\u53D7\u54EA\u4E9B\u610F\u56FE\uFF0C\u964D\u4F4E\u51B2\u7A81\u4E0E
        if \u72B6\u6001\u5224\u65AD\u3002\n\n7) \u7EDF\u4E00\u7684\u8BA2\u9605/\u89E3\u7ED1\u7BA1\u7406\n  
        - \u7528\u4E00\u4E2A\u8F85\u52A9\u5DE5\u5177\u7C7B\uFF08\u4F8B\u5982 InputActionBinder\uFF09\uFF0C\u96C6\u4E2D\u7BA1\u7406
        action += \u548C -=\uFF0C\u652F\u6301\u4E00\u952E\u6E05\u7406\uFF1B\u6216\u4F7F\u7528
        C# \u4E8B\u4EF6\u805A\u5408\u5668\u7EDF\u4E00\u8F6C\u53D1\u3002\n\n8) Aim
        \u65B9\u5411\u66F4\u65B0\n   - aimStick \u5728 performed/canceled \u90FD\u66F4\u65B0\u65B9\u5411\u662F\u5408\u7406\u7684\uFF1B\u53E6\u53EF\u8003\u8651\u5728
        Update \u4E2D\u7F13\u52A8/\u8FC7\u6EE4\u5C0F\u6296\u52A8\uFF0C\u6216\u8005\u4F7F\u7528
        Stick Deadzone Processor\u3002\n\n\u4EE5\u4E0A\u6CE8\u91CA\u4EC5\u4E3A\u9605\u8BFB\u548C\u7EF4\u62A4\u53CB\u597D\uFF0C\u4E0D\u4F1A\u6539\u53D8\u5F53\u524D\u529F\u80FD\u3002\u82E5\u9700\u8981\uFF0C\u6211\u53EF\u4EE5\u6309\u4E0A\u8FF0\u5EFA\u8BAE\u63D0\u4F9B\u4E00\u4E2A\u201C\u8D44\u4EA7\u5316
        + \u591A ActionMap\uFF08\u884C\u8D70/\u6218\u6597/\u83DC\u5355\uFF09+ \u7EDF\u4E00\u89E3\u7ED1\u201D\u7684\u91CD\u6784\u7248\u672C\u3002"
      ToolCalls: []
      Skip: 0
      AttachmentsGuids: []
      TexturesGuids: []
    - Id: 
      Role: user
      Content: "\u8BF7\u5E2E\u6211\u91CD\u6784\u4E00\u4E0B\u8FD9\u90E8\u5206\u4EE3\u7801"
      ToolCalls: []
      Skip: 0
      AttachmentsGuids: []
      TexturesGuids: []
    - Id: 
      Role: assistant
      Content: "\u4E0B\u9762\u7ED9\u51FA\u4E00\u4E2A\u53EF\u76F4\u63A5\u66FF\u6362\u7684\u91CD\u6784\u7248\u672C\uFF0C\u76EE\u6807\uFF1A\n-
        \u6E05\u7406\u672A\u7528\u5B57\u6BB5\uFF0C\u89E3\u51B3\u952E\u4F4D\u51B2\u7A81\uFF08\u4EA4\u4E92\u4ECE
        E \u6539\u4E3A F\uFF09\uFF0C\u952E\u9F20/\u624B\u67C4\u7ED1\u5B9A\u66F4\u5BF9\u79F0\u3002\n-
        \u628A\u4E8B\u4EF6\u5904\u7406\u62C6\u6210\u79C1\u6709\u65B9\u6CD5\uFF0C\u7EDF\u4E00\u7BA1\u7406\u8BA2\u9605/\u89E3\u7ED1\uFF0COnDestroy
        \u5168\u91CF\u89E3\u7ED1\uFF0C\u907F\u514D\u6CC4\u6F0F\u3002\n- handBusy
        \u771F\u6B63\u751F\u6548\uFF1A\u5DE6\u53F3\u624B\u201C\u4F7F\u7528\u201D\u652F\u6301\u6309\u65F6\u89E3\u9501\uFF1B\u201C\u6295\u63B7\u201D\u5728\u677E\u5F00\u65F6\u89E3\u9501\u3002\n-
        \u8F7B\u5EA6\u63D0\u5347\u53F3\u6447\u6746\u7784\u51C6\u7684\u7A33\u5B9A\u6027\uFF08\u6DFB\u52A0
        deadzone \u5904\u7406\u5668\uFF09\u3002\n\n\u5982\u9700\u6211\u76F4\u63A5\u5728\u5DE5\u7A0B\u91CC\u66FF\u6362\u8BE5\u811A\u672C\uFF0C\u8BF7\u544A\u8BC9\u6211\u3002\n\nusing
        System.Collections;\nusing System.Collections.Generic;\nusing UnityEngine;\nusing
        UnityEngine.InputSystem;\n\n[DefaultExecutionOrder(-10)]\npublic class MyPlayerInput
        : MonoBehaviour\n{\n    public MyCharacterController controller;\n\n    private
        InputActionMap map;\n\n    // \u57FA\u7840\u884C\u52A8\n    private InputAction
        move;\n    private InputAction jump;\n\n    // \u4F7F\u7528/\u6295\u63B7/\u7784\u51C6\n   
        private InputAction leftHand;\n    private InputAction rightHand;\n    private
        InputAction throwLeft;\n    private InputAction throwRight;\n    private
        InputAction aimStick;\n\n    // \u7CFB\u7EDF\u4E0E\u4EA4\u4E92\n    private
        InputAction openInventory;\n    private InputAction interAction;     // \u4E0E\u5730\u56FE\u4EA4\u4E92\n   
        private InputAction quickNoteTap;    // \u8BB0\u4E8B\u77ED\u6309\n    private
        InputAction noteHold;        // \u8BB0\u4E8B\u957F\u6309\n\n    // \u8BA2\u9605\u89E3\u7ED1\u96C6\u4E2D\u7BA1\u7406\n   
        private readonly List<System.Action> unbindActions = new List<System.Action>();\n\n   
        // \u624B\u90E8\u5FD9\u788C\u9501\n    private bool handBusy = false;\n   
        public float handLockDuration = 0.15f;\n\n    // \u53F3\u6447\u6746\u7784\u51C6\u65B9\u5411\uFF0C\u9ED8\u8BA4\u5411\u53F3\n   
        private Vector2 aimDir = Vector2.right;\n\n    // \u80CC\u5305\u5F00\u5173\n   
        private bool bagOpening = false;\n\n    private void Awake()\n    {\n       
        if (!controller) controller = GetComponent<MyCharacterController>();\n\n       
        map = new InputActionMap(\"Player\");\n\n        SetupMove();\n        SetupJump();\n       
        SetupUseHands();\n        SetupThrowAndAim();\n        SetupInventory();\n       
        SetupInteraction();\n        SetupNotes();\n    }\n\n    private void OnEnable()
        => map.Enable();\n    private void OnDisable() => map.Disable();\n\n    private
        void OnDestroy()\n    {\n        // \u7EDF\u4E00\u89E3\u7ED1\uFF0C\u907F\u514D\u4E8B\u4EF6\u6CC4\u6F0F\n       
        for (int i = unbindActions.Count - 1; i >= 0; i--)\n        {\n           
        try { unbindActions[i]?.Invoke(); }\n            catch { /* \u5FFD\u7565\u5F02\u5E38\uFF0C\u5C3D\u91CF\u91CA\u653E
        */ }\n        }\n        unbindActions.Clear();\n\n        map?.Dispose();\n   
        }\n\n    #region Setup\n\n    private void SetupMove()\n    {\n        move
        = map.AddAction(name: \"Move\", type: InputActionType.Value);\n        move.expectedControlType
        = \"Vector2\";\n\n        var wasd = move.AddCompositeBinding(\"2DVector\");\n       
        wasd.With(\"up\", \"<Keyboard>/w\");\n        wasd.With(\"down\", \"<Keyboard>/s\");\n       
        wasd.With(\"left\", \"<Keyboard>/a\");\n        wasd.With(\"right\", \"<Keyboard>/d\");\n\n       
        move.AddBinding(\"<Gamepad>/leftStick\");\n\n        System.Action<InputAction.CallbackContext>
        moveHandler = controller.OnMove;\n        move.performed += moveHandler;\n       
        move.canceled += moveHandler;\n\n        unbindActions.Add(() => { move.performed
        -= moveHandler; move.canceled -= moveHandler; });\n    }\n\n    private void
        SetupJump()\n    {\n        jump = map.AddAction(name: \"Jump\", type: InputActionType.Button);\n       
        jump.AddBinding(\"<Keyboard>/space\");\n        jump.AddBinding(\"<Gamepad>/buttonSouth\");\n\n       
        System.Action<InputAction.CallbackContext> jumpHandler = controller.OnJump;\n       
        jump.performed += jumpHandler;\n\n        unbindActions.Add(() => jump.performed
        -= jumpHandler);\n    }\n\n    private void SetupUseHands()\n    {\n       
        leftHand = map.AddAction(\"UseLeftHand\", type: InputActionType.Button);\n       
        rightHand = map.AddAction(\"UseRightHand\", type: InputActionType.Button);\n\n       
        // \u952E\u76D8\uFF1AQ/E \u4F5C\u4E3A\u5DE6\u53F3\u624B\n        leftHand.AddBinding(\"<Keyboard>/q\");\n       
        rightHand.AddBinding(\"<Keyboard>/e\");\n\n        // \u624B\u67C4\u80A9\u952E\uFF1ALB/RB\n       
        leftHand.AddBinding(\"<Gamepad>/leftShoulder\");\n        rightHand.AddBinding(\"<Gamepad>/rightShoulder\");\n\n       
        System.Action<InputAction.CallbackContext> leftHandler = OnLeftHandPerformed;\n       
        System.Action<InputAction.CallbackContext> rightHandler = OnRightHandPerformed;\n\n       
        leftHand.performed += leftHandler;\n        rightHand.performed += rightHandler;\n\n       
        unbindActions.Add(() => leftHand.performed -= leftHandler);\n        unbindActions.Add(()
        => rightHand.performed -= rightHandler);\n    }\n\n    private void SetupThrowAndAim()\n   
        {\n        // \u53F3\u6447\u6746\u7784\u51C6\uFF0C\u52A0\u5165 deadzone \u5904\u7406\n       
        aimStick = map.AddAction(\"Aim\", InputActionType.Value);\n        aimStick.expectedControlType
        = \"Vector2\";\n        aimStick.AddBinding(\"<Gamepad>/rightStick\").WithProcessor(\"stickDeadzone(min=0.25)\");\n\n       
        System.Action<InputAction.CallbackContext> aimChanged = OnAimChanged;\n       
        aimStick.performed += aimChanged;\n        aimStick.canceled += aimChanged;\n\n       
        unbindActions.Add(() => { aimStick.performed -= aimChanged; aimStick.canceled
        -= aimChanged; });\n\n        // \u5DE6\u53F3\u6295\u63B7\uFF1ALT/RT\uFF1B\u952E\u76D8\u5BF9\u79F0
        O/P\n        throwLeft = map.AddAction(\"ThrowLeft\", InputActionType.Button);\n       
        throwLeft.AddBinding(\"<Gamepad>/leftTrigger\");\n        throwLeft.AddBinding(\"<Keyboard>/o\");\n\n       
        throwRight = map.AddAction(\"ThrowRight\", InputActionType.Button);\n       
        throwRight.AddBinding(\"<Gamepad>/rightTrigger\");\n        throwRight.AddBinding(\"<Keyboard>/p\");\n\n       
        System.Action<InputAction.CallbackContext> leftStarted = OnThrowLeftStarted;\n       
        System.Action<InputAction.CallbackContext> leftCanceled = OnThrowLeftCanceled;\n       
        System.Action<InputAction.CallbackContext> rightStarted = OnThrowRightStarted;\n       
        System.Action<InputAction.CallbackContext> rightCanceled = OnThrowRightCanceled;\n\n       
        throwLeft.started += leftStarted;\n        throwLeft.canceled += leftCanceled;\n       
        throwRight.started += rightStarted;\n        throwRight.canceled += rightCanceled;\n\n       
        unbindActions.Add(() => { throwLeft.started -= leftStarted; throwLeft.canceled
        -= leftCanceled; });\n        unbindActions.Add(() => { throwRight.started
        -= rightStarted; throwRight.canceled -= rightCanceled; });\n    }\n\n   
        private void SetupInventory()\n    {\n        openInventory = map.AddAction(\"OpenInventory\",
        InputActionType.Button);\n        openInventory.AddBinding(\"<Keyboard>/tab\");\n       
        openInventory.AddBinding(\"<Gamepad>/buttonNorth\");\n\n        System.Action<InputAction.CallbackContext>
        onInv = OnOpenInventoryPerformed;\n        openInventory.performed += onInv;\n\n       
        unbindActions.Add(() => openInventory.performed -= onInv);\n    }\n\n   
        private void SetupInteraction()\n    {\n        interAction = map.AddAction(\"TradeOrSpecial\",
        InputActionType.Button);\n\n        // \u89E3\u51B3\u4E0E\u53F3\u624B(E)\u51B2\u7A81\uFF1A\u6539\u4E3A
        F\n        interAction.AddBinding(\"<Keyboard>/f\");\n        interAction.AddBinding(\"<Gamepad>/buttonEast\");\n\n       
        System.Action<InputAction.CallbackContext> onInteract = controller.OnSpecial;\n       
        interAction.performed += onInteract;\n\n        unbindActions.Add(() => interAction.performed
        -= onInteract);\n    }\n\n    private void SetupNotes()\n    {\n        //
        \u77ED\u6309\uFF08X / N\uFF09\n        quickNoteTap = map.AddAction(\"QuickNoteTap\",
        InputActionType.Button);\n        quickNoteTap.AddBinding(\"<Gamepad>/buttonWest\");\n       
        quickNoteTap.AddBinding(\"<Keyboard>/n\");\n\n        System.Action<InputAction.CallbackContext>
        noteTap = controller.OnQuickNoteTap;\n        quickNoteTap.performed += noteTap;\n       
        unbindActions.Add(() => quickNoteTap.performed -= noteTap);\n\n        //
        \u957F\u6309\uFF08hold 0.5s\uFF09\n        noteHold = map.AddAction(\"NoteHold\",
        InputActionType.Button);\n        var holdPad = noteHold.AddBinding(\"<Gamepad>/buttonWest\");\n       
        holdPad.WithInteractions(\"hold(duration=0.5)\");\n        var holdKey =
        noteHold.AddBinding(\"<Keyboard>/n\");\n        holdKey.WithInteractions(\"hold(duration=0.5)\");\n\n       
        System.Action<InputAction.CallbackContext> noteHoldHandler = controller.OnNoteHold;\n       
        noteHold.performed += noteHoldHandler;\n        unbindActions.Add(() => noteHold.performed
        -= noteHoldHandler);\n    }\n\n    #endregion\n\n    #region Handlers\n\n   
        private void OnLeftHandPerformed(InputAction.CallbackContext ctx)\n    {\n       
        if (handBusy) return;\n        handBusy = true;\n        controller.OnUseLeftHand(ctx);\n       
        // \u4F7F\u7528\u7C7B\u52A8\u4F5C\uFF1A\u6309\u65F6\u89E3\u9501\uFF0C\u907F\u514D\u6C38\u4E45
        busy\n        StartCoroutine(HandAutoUnlock(handLockDuration));\n    }\n\n   
        private void OnRightHandPerformed(InputAction.CallbackContext ctx)\n    {\n       
        if (handBusy) return;\n        handBusy = true;\n        controller.OnUseRightHand(ctx);\n       
        StartCoroutine(HandAutoUnlock(handLockDuration));\n    }\n\n    private void
        OnAimChanged(InputAction.CallbackContext ctx)\n    {\n        Vector2 v =
        ctx.ReadValue<Vector2>();\n        if (v.sqrMagnitude > 0.0001f)\n           
        aimDir = v.normalized;\n\n        controller.UpdateAimDirection(aimDir);\n   
        }\n\n    private void OnThrowLeftStarted(InputAction.CallbackContext ctx)\n   
        {\n        if (handBusy) return;\n        handBusy = true;\n        controller.BeginAim(true);
        // \u5DE6\u624B\u5F00\u59CB\u7784\u51C6\n    }\n\n    private void OnThrowLeftCanceled(InputAction.CallbackContext
        ctx)\n    {\n        controller.ReleaseAim(ctx); // \u5DE6\u624B\u91CA\u653E\u6295\u63B7\n       
        handBusy = false;\n    }\n\n    private void OnThrowRightStarted(InputAction.CallbackContext
        ctx)\n    {\n        if (handBusy) return;\n        handBusy = true;\n       
        controller.BeginAim(false); // \u53F3\u624B\u5F00\u59CB\u7784\u51C6\n   
        }\n\n    private void OnThrowRightCanceled(InputAction.CallbackContext ctx)\n   
        {\n        controller.ReleaseAim(ctx); // \u53F3\u624B\u91CA\u653E\u6295\u63B7\n       
        handBusy = false;\n    }\n\n    private void OnOpenInventoryPerformed(InputAction.CallbackContext
        ctx)\n    {\n        if (!bagOpening)\n        {\n            bagOpening
        = true;\n            controller.OnOpenInventory(ctx);\n        }\n       
        else\n        {\n            bagOpening = false;\n            controller.OnCloseInventory(ctx);\n       
        }\n    }\n\n    #endregion\n\n    #region Utils\n\n    private IEnumerator
        HandAutoUnlock(float duration)\n    {\n        if (duration <= 0f)\n       
        {\n            handBusy = false;\n            yield break;\n        }\n       
        yield return new WaitForSeconds(duration);\n        handBusy = false;\n   
        }\n\n    #endregion\n}\n\n\u8BF4\u660E\uFF1A\n- \u4EA4\u4E92\u952E\u4ECE
        E \u6539\u4E3A F\uFF0C\u907F\u514D\u4E0E\u53F3\u624B\u4F7F\u7528(E)\u51B2\u7A81\u3002\u5982\u9700\u4FDD\u7559
        E \u4E3A\u4EA4\u4E92\uFF0C\u53EF\u628A\u53F3\u624B\u4F7F\u7528\u6539\u952E\u6216\u5728\u4E0D\u540C\u72B6\u6001\u4F7F\u7528\u4E0D\u540C
        ActionMap\u3002\n- \u6295\u63B7\u952E\u76D8\u7ED1\u5B9A\u5DE6\u53F3\u5BF9\u79F0\u4E3A
        O/P\uFF08\u624B\u67C4 LT/RT \u4E0D\u53D8\uFF09\u3002\n- \u5DE6\u53F3\u201C\u4F7F\u7528\u201D\u884C\u4E3A\u4F1A\u5728
        handLockDuration \u540E\u81EA\u52A8\u89E3\u9501\uFF1B\u6295\u63B7\u884C\u4E3A\u5728\u677E\u5F00\u65F6\u89E3\u9501\u3002\n-
        \u6240\u6709\u4E8B\u4EF6\u8BA2\u9605\u90FD\u96C6\u4E2D\u6CE8\u518C\u5E76\u5728
        OnDestroy \u4E2D\u6210\u5BF9\u89E3\u7ED1\uFF0C\u9632\u6B62\u4E8B\u4EF6\u6CC4\u6F0F\u3002\n-
        \u53F3\u6447\u6746\u52A0\u5165 stickDeadzone(min=0.25) \u5904\u7406\u5668\uFF0C\u51CF\u5C11\u5FAE\u6296\u52A8\u5F71\u54CD\u3002\u53EF\u6839\u636E\u624B\u611F\u8C03\u6574\u6570\u503C\u3002"
      ToolCalls: []
      Skip: 0
      AttachmentsGuids: []
      TexturesGuids: []
    - Id: 
      Role: user
      Content: "\u8BF7\u5728\u5DE5\u7A0B\u4E2D\u76F4\u63A5\u66FF\u6362\u8BE5\u811A\u672C"
      ToolCalls: []
      Skip: 0
      AttachmentsGuids: []
      TexturesGuids: []
    - Id: 
      Role: assistant
      Content: 
      ToolCalls:
      - id: call_ubDCiS3G2DJrBe9iNEYMHXUS
        type: 
        function:
          name: get_sources
          arguments: "{\"class\":\"MyPlayerInput\",\"userMessage\":\"\u6211\u5C06\u66FF\u6362
            MyPlayerInput \u7684\u6E90\u7801\u4E3A\u91CD\u6784\u7248\u672C\u3002\"}"
      Skip: 0
      AttachmentsGuids: []
      TexturesGuids: []
    - Id: 
      Role: tool
      Content: "-----BEGINNING OF THE FILE-----\nusing UnityEngine;\r\nusing UnityEngine.InputSystem;\r\n//\u7528\u4E8E\u7ED1\u5B9A\u52A8\u4F5C\u952E\u76D8\u3001\u624B\u67C4\u8F93\u5165\r\n[DefaultExecutionOrder(-10)]\r\npublic
        class MyPlayerInput : MonoBehaviour\r\n{\r\n    public MyCharacterController
        controller;\r\n\r\n    private InputActionMap map;\r\n    private InputAction
        move;\r\n    private InputAction jump;\r\n    private InputAction leftHand;\r\n   
        private InputAction rightHand;\r\n    private InputAction aimLeft;\r\n   
        private InputAction aimRight;\r\n    private InputAction throwLeft;\r\n   
        private InputAction throwRight;\r\n    private InputAction aimStick;\r\n   
        private InputAction openInventory;\r\n    private InputAction interAction;//\u4E0E\u5730\u56FE\u4EA4\u4E92\r\n   
        private InputAction quickNoteTap;\r\n    private InputAction noteHold;\r\n\r\n   
        private bool handBusy = false;\r\n    public float handLockDuration = 0.15f;\r\n\r\n   
        private Vector2 aimDir = Vector2.right;\r\n\r\n    bool bagOpening = false;\r\n\r\n   
        void Awake()\r\n    {\r\n        if (!controller) controller = GetComponent<MyCharacterController>();\r\n\r\n       
        map = new InputActionMap(\"Player\");\r\n\r\n        //\u5DE6\u53F3\u79FB\u52A8\r\n       
        {\r\n            move = map.AddAction(name: \"Move\", type: InputActionType.Value);\r\n           
        move.expectedControlType = \"Vector2\";\r\n            var wasd = move.AddCompositeBinding(\"2DVector\");\r\n           
        wasd.With(\"up\", \"<Keyboard>/w\");\r\n            wasd.With(\"down\", \"<Keyboard>/s\");\r\n           
        wasd.With(\"left\", \"<Keyboard>/a\");\r\n            wasd.With(\"right\",
        \"<Keyboard>/d\");\r\n\r\n            //\u7ED1\u5B9A\u624B\u67C4\u5DE6\u6447\u6746    
        \r\n            move.AddBinding(\"<Gamepad>/leftStick\");\r\n\r\n           
        // \u7ED1\u5B9Amove\r\n            move.performed += controller.OnMove;\r\n           
        move.canceled += controller.OnMove;\r\n        }\r\n\r\n        //\u8D77\u8DF3\r\n       
        {\r\n            jump = map.AddAction(name: \"Jump\", type: InputActionType.Button);\r\n           
        jump.AddBinding(\"<Keyboard>/space\");\r\n\r\n            //\u952E\u76D8\u7ED1\u5B9A\u624B\u67C4\r\n           
        jump.AddBinding(\"<Gamepad>/buttonSouth\");\r\n\r\n            //\u7ED1\u5B9Ajump\r\n           
        jump.performed += controller.OnJump;\r\n        }\r\n\r\n        //\u5DE6\u53F3\u624B\u4F7F\u7528\r\n       
        {\r\n            leftHand = map.AddAction(\"UseLeftHand\", type: InputActionType.Button);\r\n           
        rightHand = map.AddAction(\"UseRightHand\", type: InputActionType.Button);\r\n           
        leftHand.AddBinding(\"<Keyboard>/q\");//\u952E\u76D8\u5DE6\u53F3\u624B\u653B\u51FB\r\n           
        rightHand.AddBinding(\"<Keyboard>/e\");\r\n            leftHand.AddBinding(\"<Gamepad>/leftShoulder\");  
        // LB\r\n            rightHand.AddBinding(\"<Gamepad>/rightShoulder\"); 
        // RB\r\n            leftHand.performed += ctx => \r\n            {\r\n               
        if (!handBusy)\r\n                {\r\n                    handBusy = true;\r\n                   
        controller.OnUseLeftHand(ctx);\r\n                }\r\n            };\r\n           
        rightHand.performed += ctx =>\r\n            {\r\n                if (!handBusy)\r\n               
        {\r\n                    handBusy = true;\r\n                    controller.OnUseRightHand(ctx);\r\n               
        }\r\n            };\r\n        }\r\n        //\u5DE6\u53F3\u624B\u4E22\u51FA\r\n       
        {\r\n            //\u7ED1\u5B9A\u53F3\u6447\u6746\r\n            {\r\n               
        aimStick = map.AddAction(\"Aim\", InputActionType.Value);\r\n               
        aimStick.expectedControlType = \"Vector2\";\r\n                aimStick.AddBinding(\"<Gamepad>/rightStick\");\r\n               
        aimStick.performed += ctx =>\r\n                {\r\n                   
        Vector2 v = ctx.ReadValue<Vector2>();\r\n                    if (v.sqrMagnitude
        > 0.0001f)\r\n                        aimDir = v.normalized;\r\n                   
        controller.UpdateAimDirection(aimDir);\r\n                };\r\n               
        aimStick.canceled += ctx =>\r\n                {\r\n                    Vector2
        v = ctx.ReadValue<Vector2>();\r\n                    if (v.sqrMagnitude >
        0.0001f)\r\n                        aimDir = v.normalized;\r\n                   
        controller.UpdateAimDirection(aimDir);\r\n                };\r\n               
        \r\n            }\r\n            //\u5DE6\u53F3\u4E22\u51FA\r\n           
        {\r\n                throwLeft = map.AddAction(\"ThrowLeft\", InputActionType.Button);\r\n               
        throwLeft.AddBinding(\"<Gamepad>/leftTrigger\");\r\n                throwLeft.AddBinding(\"<Keyboard>/p\");\r\n               
        throwLeft.started += ctx =>\r\n                  {\r\n                     
        if (!handBusy)\r\n                      {\r\n                          Debug.Log(\"\u6309\u4E0Bp\");\r\n                         
        handBusy = true;\r\n                          controller.BeginAim(true);\r\n                     
        }\r\n                  };\r\n                throwRight = map.AddAction(\"ThrowRight\",
        InputActionType.Button);\r\n                throwRight.AddBinding(\"<Gamepad>/rightTrigger\");\r\n               
        throwRight.started += ctx =>\r\n                 {\r\n                    
        if (!handBusy)\r\n                     {\r\n                         handBusy
        = true;\r\n                         controller.BeginAim(false);\r\n                   
        }\r\n                 };\r\n                throwLeft.canceled += ctx =>\r\n                
        {\r\n                     Debug.Log(\"\u5DE6\u624B\u4E22\u51FA\");\r\n                    
        controller.ReleaseAim(ctx);\r\n                     handBusy = false;\r\n                
        };\r\n                throwRight.canceled += ctx =>\r\n                {\r\n                   
        controller.ReleaseAim(ctx);\r\n                    handBusy = false;\r\n               
        };\r\n\r\n            }\r\n        }\r\n\r\n\r\n        // ---- \u80CC\u5305
        (Y / Tab) ----\r\n        {\r\n            openInventory = map.AddAction(\"OpenInventory\",
        InputActionType.Button);\r\n            openInventory.AddBinding(\"<Keyboard>/tab\");\r\n           
        openInventory.AddBinding(\"<Gamepad>/buttonNorth\");\r\n            openInventory.performed
        += ctx =>\r\n             {\r\n                 if (!bagOpening)\r\n                
        {\r\n                     bagOpening = true;\r\n                     controller.OnOpenInventory(ctx);\r\n                
        }\r\n                 else\r\n                 {\r\n                    
        bagOpening = false;\r\n                     controller.OnCloseInventory(ctx);\r\n                
        }\r\n             };\r\n        }\r\n\r\n\r\n        // ---- \u4EA4\u6613/\u7279\u6B8A\u4EA4\u4E92
        (B / E) ----\r\n        {\r\n            interAction = map.AddAction(\"TradeOrSpecial\",
        InputActionType.Button);\r\n            interAction.AddBinding(\"<Keyboard>/e\");\r\n           
        interAction.AddBinding(\"<Gamepad>/buttonEast\");\r\n            interAction.performed
        += ctx =>\r\n            {\r\n                controller.OnSpecial(ctx);\r\n           
        };\r\n        }\r\n\r\n        // ---- \u8BB0\u4E8B (X \u77ED\u6309 / \u957F\u63090.5s)
        ----\r\n        {\r\n            quickNoteTap = map.AddAction(\"QuickNoteTap\",
        InputActionType.Button);\r\n            quickNoteTap.AddBinding(\"<Gamepad>/buttonWest\");\r\n           
        quickNoteTap.AddBinding(\"<Keyboard>/n\");\r\n            quickNoteTap.performed
        += ctx =>\r\n            {\r\n                controller.OnQuickNoteTap(ctx);\r\n           
        };\r\n        }\r\n        \r\n        {\r\n            noteHold = map.AddAction(\"NoteHold\",
        InputActionType.Button);\r\n            var holdPad = noteHold.AddBinding(\"<Gamepad>/buttonWest\");\r\n           
        holdPad.WithInteractions (\"hold(duration=0.5)\");\r\n            var holdKey
        = noteHold.AddBinding(\"<Keyboard>/n\");\r\n            holdKey.WithInteractions(
        \"hold(duration=0.5)\");\r\n            noteHold.performed += ctx =>\r\n            
        {\r\n                 controller.OnNoteHold(ctx);\r\n             };\r\n       
        }\r\n    }\r\n\r\n    void OnEnable() => map.Enable();\r\n    void OnDisable()
        => map.Disable();\r\n\r\n    void OnDestroy()\r\n    {\r\n        move.performed
        -= controller.OnMove;\r\n        move.canceled -= controller.OnMove;\r\n       
        map.Dispose();\r\n    }\r\n}\r\n\n-----END OF THE FILE-----"
      ToolCalls:
      - id: call_ubDCiS3G2DJrBe9iNEYMHXUS
        type: 
        function:
          name: get_sources
          arguments: "{\"class\":\"MyPlayerInput\",\"userMessage\":\"\u6211\u5C06\u66FF\u6362
            MyPlayerInput \u7684\u6E90\u7801\u4E3A\u91CD\u6784\u7248\u672C\u3002\"}"
      Skip: 1
      AttachmentsGuids: []
      TexturesGuids: []
  ollamaHistory: []
  deepseekHistory: []
  geminiHistory: []
  claudeHistory: []
